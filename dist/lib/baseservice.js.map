{"version":3,"sources":["../../src/lib/baseservice.js"],"names":["module","exports","model","search","sort","tstamp","_search","then","res","records","id","findById","_id","__","_","isArray","resp","json","createTime","Date","now","_create","create"],"mappings":"AAAA;;;;AAEA;;;;;;;;AAEAA,OAAOC,OAAP;AACI,yBAAYC,KAAZ,EAAmB;AAAA;;AACf,aAAKA,KAAL,GAAaA,KAAb;AACH;;AAHL;AAAA;AAAA,+BAIWC,OAJX,EAImB;AACXA,oBAAOC,IAAP,GAAc;AACVC,wBAAQ,CAAC;AADC,aAAd;AAGA,mBAAO,KAAKC,OAAL,CAAaH,OAAb,CAAP;AACH;AATL;AAAA;AAAA,gCAWYA,MAXZ,EAWoB;AACZ,mBAAO,KAAKD,KAAL,CAAWC,MAAX,CAAkBA,MAAlB,EAA0BI,IAA1B,CAA+B,eAAO;AACzC,uBAAOC,OAAOA,IAAIC,OAAX,GAAqBD,IAAIC,OAAzB,GAAmCD,GAA1C;AACH,aAFM,CAAP;AAGH;AAfL;AAAA;AAAA,iCAiBaE,EAjBb,EAiBiB;AACT,mBAAO,KAAKR,KAAL,CAAWS,QAAX,CAAoB,EAAEC,KAAKF,EAAP,EAApB,EAAiCH,IAAjC,CAAsC,gBAAQ;AACjD,uBAAOM,eAAGC,CAAH,CAAKC,OAAL,CAAaC,IAAb,IAAqBA,KAAK,CAAL,CAArB,GAA+BA,IAAtC;AACH,aAFM,CAAP;AAGH;AArBL;AAAA;AAAA,+BAuBWC,IAvBX,EAuBiB;AACTA,iBAAKC,UAAL,GAAkBD,KAAKC,UAAL,IAAmBC,KAAKC,GAAL,EAArC;AACA,mBAAO,KAAKC,OAAL,CAAaJ,IAAb,CAAP;AACH;AA1BL;AAAA;AAAA,gCA4BYA,IA5BZ,EA4BkB;AACV,mBAAO,KAAKf,KAAL,CAAWoB,MAAX,CAAkB,IAAI,KAAKpB,KAAT,CAAee,IAAf,CAAlB,CAAP;AACH;AA9BL;;AAAA;AAAA","file":"baseservice.js","sourcesContent":["'use strict';\n\nimport __ from './util';\n\nmodule.exports = class BaseService {\n    constructor(model) {\n        this.model = model\n    }\n    search(search) {\n        search.sort = {\n            tstamp: -1\n        }\n        return this._search(search)\n    }\n\n    _search(search) {\n        return this.model.search(search).then(res => {\n            return res && res.records ? res.records : res\n        })\n    }\n\n    findById(id) {\n        return this.model.findById({ _id: id }).then(resp => {\n            return __._.isArray(resp) ? resp[0] : resp;\n        })\n    }\n\n    create(json) {\n        json.createTime = json.createTime || Date.now();\n        return this._create(json)\n    }\n\n    _create(json) {\n        return this.model.create(new this.model(json))\n    }\n}"]}